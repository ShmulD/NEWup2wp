(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5501:function(e,t,s){Promise.resolve().then(s.bind(s,3504))},3504:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return n}});var r=s(3827),a=s(5118),l=s(4090);function n(){let[e,t]=(0,l.useState)(""),[s,n]=(0,l.useState)(""),[i,o]=(0,l.useState)(""),[c,d]=(0,l.useState)([]),[x,u]=(0,l.useState)(!1),[m,g]=(0,l.useState)(null),[h,p]=(0,l.useState)([]),b=()=>h.filter(t=>{let r=t.name.toLowerCase().includes(e.toLowerCase()),a=!s||t.tags.includes(s);return r&&a});(0,l.useEffect)(()=>{let e=b();1===e.length?o(e[0].id.toString()):o("")},[e,s,h]),(0,l.useEffect)(()=>{let e=localStorage.getItem("websites");e&&p(JSON.parse(e))},[]),(0,l.useEffect)(()=>{localStorage.setItem("websites",JSON.stringify(h))},[h]);let[f,y]=(0,l.useState)(!1),[j,v]=(0,l.useState)(""),[N,w]=(0,l.useState)(""),[k,S]=(0,l.useState)(""),[C,E]=(0,l.useState)(""),[O,P]=(0,l.useState)(""),_=async e=>{try{(await fetch("".concat(e.url,"/wp-json/wp/v2/posts"),{headers:{Authorization:"Basic "+btoa("".concat(e.username,":").concat(e.appPassword))}})).ok?alert("החיבור לאתר תקין!"):alert("שגיאה בחיבור לאתר. אנא בדוק את פרטי ההתחברות.")}catch(e){alert("שגיאה בחיבור לאתר. אנא בדוק שהכתובת נכונה ושה-API של וורדפרס פעיל.")}},L=e=>{confirm("האם אתה בטוח שברצונך למחוק את האתר?")&&p(h.filter(t=>t.id!==e))},A=async()=>{if(!m||!i)return;u(!0);let e=h.find(e=>e.id===parseInt(i));if(e)try{for(let t of m)try{let s=await t.arrayBuffer(),r=(await a.convertToHtml({arrayBuffer:s})).value,l=await fetch("".concat(e.url,"/wp-json/wp/v2/posts"),{method:"POST",headers:{Authorization:"Basic "+btoa("".concat(e.username,":").concat(e.appPassword)),"Content-Type":"application/json"},body:JSON.stringify({title:t.name.replace(".docx","").replace(".doc",""),content:r,status:"publish"})});if(!l.ok)throw Error("שגיאה ביצירת הפוסט ".concat(t.name));let n=await l.json();d(s=>[...s,{name:t.name,status:"פורסם בהצלחה",website:e.name,url:n.link}])}catch(s){d(r=>[...r,{name:t.name,status:"נכשל",website:e.name,error:s.message}])}alert("תהליך ההעלאה הסתיים")}catch(e){alert("שגיאה כללית: "+e.message)}finally{u(!1),g(null)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",dir:"rtl",children:[(0,r.jsx)("div",{className:"bg-white shadow",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"מערכת העלאת מאמרים"}),(0,r.jsx)("button",{onClick:()=>y(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"ניהול אתרים"})]})})}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"סינון אתרים"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"חיפוש חופשי"}),(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"הקלד שם אתר...",className:"w-full rounded-md border border-gray-300 p-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"סינון לפי תגית"}),(0,r.jsxs)("select",{value:s,onChange:e=>n(e.target.value),className:"w-full rounded-md border border-gray-300 p-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"",children:"כל התגיות"}),[...new Set(h.flatMap(e=>e.tags))].map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"בחירת אתר"}),(0,r.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full rounded-md border border-gray-300 p-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"",children:"בחר אתר..."}),b().map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})}),(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"העלאת מאמרים"}),(0,r.jsx)("input",{type:"file",accept:".doc,.docx",multiple:!0,onChange:e=>g(Array.from(e.target.files)),className:"block w-full text-sm text-gray-500 mb-4 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 focus:outline-none"}),(null==m?void 0:m.length)>0&&i&&(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{onClick:()=>A(),disabled:x,className:"bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors ".concat(x?"opacity-50 cursor-not-allowed":""),children:x?"מעלה...":"העלה ".concat(m.length," מאמרים")}),(0,r.jsx)("div",{className:"mt-4 space-y-2",children:m.map(e=>(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.name]},e.name))})]}),(null==m?void 0:m.length)>0&&!i&&(0,r.jsx)("div",{className:"bg-red-50 text-red-500 text-sm p-3 rounded-lg",children:"יש לבחור אתר לפני העלאת המאמרים"})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"היסטוריית העלאות"})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"שם המאמר"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"סטטוס"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"אתר"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===c.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"3",className:"px-6 py-8 text-center text-sm text-gray-500",children:"טרם הועלו מאמרים"})}):c.map((e,t)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.name}),(0,r.jsxs)("td",{className:"px-6 py-4 text-sm ".concat("נכשל"===e.status?"text-red-500":"פורסם בהצלחה"===e.status?"text-green-500":"text-gray-500"),children:[e.status,e.error&&(0,r.jsx)("div",{className:"text-xs text-red-400 mt-1",children:e.error})]}),(0,r.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500",children:[e.website,e.url&&(0,r.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"block text-blue-500 hover:text-blue-700 text-xs mt-1",children:"צפה בפוסט"})]})]},t))})]})})]})]})]})}),f&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-[800px] max-h-[80vh] overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"ניהול אתרי וורדפרס"})}),(0,r.jsxs)("div",{className:"p-6 overflow-y-auto",children:[(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"הוספת אתר חדש"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)("input",{type:"text",value:j,onChange:e=>v(e.target.value),placeholder:"שם האתר",className:"block w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,r.jsx)("input",{type:"url",value:N,onChange:e=>w(e.target.value),placeholder:"כתובת האתר (URL)",className:"block w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,r.jsx)("input",{type:"text",value:k,onChange:e=>S(e.target.value),placeholder:"שם משתמש",className:"block w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,r.jsx)("input",{type:"text",value:C,onChange:e=>E(e.target.value),placeholder:"Application Password",className:"block w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,r.jsx)("input",{type:"text",value:O,onChange:e=>P(e.target.value),placeholder:"תגיות (מופרדות בפסיק)",className:"block w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent col-span-2"})]}),(0,r.jsx)("button",{onClick:()=>{if(""===j.trim()||""===N.trim()||""===k.trim()||""===C.trim()){alert("נא למלא את כל השדות");return}try{new URL(N)}catch(e){alert("נא להזין כתובת אתר תקינה");return}let e=O.split(",").map(e=>e.trim()).filter(e=>""!==e),t={id:Math.max(0,...h.map(e=>e.id))+1,name:j.trim(),url:N.trim(),username:k.trim(),appPassword:C.trim(),tags:e},s=[...h,t];p(s),localStorage.setItem("websites",JSON.stringify(s)),v(""),w(""),S(""),E(""),P("")},className:"mt-4 bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors",children:"הוסף אתר"})]}),(0,r.jsx)("div",{className:"space-y-4",children:h.map(e=>(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.url}),(0,r.jsx)("div",{className:"flex gap-2 mt-2",children:e.tags.map(e=>(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e},e))})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>_(e),className:"inline-flex items-center px-3 py-1 border border-blue-500 text-blue-500 rounded-lg hover:bg-blue-50 transition-colors text-sm",children:"בדוק חיבור"}),(0,r.jsx)("button",{onClick:()=>L(e.id),className:"inline-flex items-center px-3 py-1 border border-red-500 text-red-500 rounded-lg hover:bg-red-50 transition-colors text-sm",children:"מחק"})]})]})},e.id))})]}),(0,r.jsx)("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:(0,r.jsx)("button",{onClick:()=>y(!1),className:"w-full bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"סגור"})})]})})]})}}},function(e){e.O(0,[565,551,118,971,69,744],function(){return e(e.s=5501)}),_N_E=e.O()}]);